import{a as D,t as ge,n as oe}from"./disclose-version.D1cl9r6R.js";import{a4 as ve,k as pe,_ as be,h as G,ay as ye,u as we,j as xe,p as ke,au as b,g as t,s as v,al as Ae,t as F,a as Se,A as o,c as y,r as w,J as Me}from"./runtime.DcUOeyHB.js";import{l as Ne,d as Ee,s as ne}from"./render.CIZPRaGG.js";import{e as se,i as ie}from"./each.BhopzhV1.js";import{r as O,s as x}from"./attributes.DZQztxHe.js";import{p as A}from"./proxy.Dmv61e2d.js";const Ie=[];function Pe(e,n=!1){return E(e,new Map,"",Ie)}function E(e,n,l,c,f=null){if(typeof e=="object"&&e!==null){var i=n.get(e);if(i!==void 0)return i;if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(ve(e)){var u=Array(e.length);n.set(e,u),f!==null&&n.set(f,u);for(var _=0;_<e.length;_+=1){var S=e[_];_ in e&&(u[_]=E(S,n,l,c))}return u}if(pe(e)===be){u={},n.set(e,u),f!==null&&n.set(f,u);for(var d in e)u[d]=E(e[d],n,l,c);return u}if(e instanceof Date)return structuredClone(e);if(typeof e.toJSON=="function")return E(e.toJSON(),n,l,c,e)}if(e instanceof EventTarget)return e;try{return structuredClone(e)}catch{return e}}function ze(e,n){var l=e.__className,c=Te(n);G&&e.className===c?e.__className=c:(l!==c||G&&e.className!==c)&&(n==null?e.removeAttribute("class"):e.className=c,e.__className=c)}function Te(e){return e??""}function V(e,n,l=n){var c=ye();Ne(e,"input",f=>{var i=f?e.defaultValue:e.value;if(i=Z(e)?R(i):i,l(i),c&&i!==(i=n())){var u=e.selectionStart,_=e.selectionEnd;e.value=i??"",_!==null&&(e.selectionStart=u,e.selectionEnd=Math.min(_,e.value.length))}}),(G&&e.defaultValue!==e.value||we(n)==null&&e.value)&&l(Z(e)?R(e.value):e.value),xe(()=>{var f=n();Z(e)&&f===R(e.value)||e.type==="date"&&!f&&!e.value||f!==e.value&&(e.value=f??"")})}function Z(e){var n=e.type;return n==="number"||n==="range"}function R(e){return e===""?null:+e}const Ze={layout:"post",title:"Beam search nearest neighbors",summary:"A visualization of my favorite algorithm",date:"2015-12-28T00:00:00.000Z",updated:"2025-03-12T00:00:00.000Z"};function je(e,n,l){n[t(l)]()}var Be=oe("<circle></circle>"),We=oe('<line width="3" stroke="grey"></line>'),qe=ge('<p>A common problem is finding the nearest neighbors of a given object in some search space. <a href="https://en.wikipedia.org/wiki/Beam_search" rel="nofollow">Beam search</a> is an “anytime” heuristic search algorithm which very efficiently accomplishes this.</p> <p>Imagine we have a set of N nodes, each randomly “closest” (connected by an edge) to n other nodes. The algorithm works as follows:</p> <ol><li>Pick a node; paint it red.</li> <li>Paint its neighbors grey. Also paint the neighbors for each of those neighbors.</li> <li>“Fix” the edges of the red node by connecting it to the closest of these grey nodes.</li> <li>Repeat for each node.</li></ol> <p>Click to proceed with the algorithm: <button> </button></p> <div class="flex"><div>Number of nodes: <input class="w-8 text-blue-500"></div> <div>Number of neighbors to find: <input class="w-8 text-blue-500"></div> <div> <input class="w-8 text-blue-500"></div></div> <div class="w-full flex justify-center mt-12 mb-32"><svg class="w-full mx-auto" viewBox="0 0 1000 300"><!><!></svg></div>',1);function Re(e,n){ke(n,!0);let l=b(50),c=b(3),f=b(75),i=b(A(new Array(t(l))));const u=1e3,_=300;let S=b(!1),d=b(A({})),H=Me(()=>{const r=[];for(const a in t(d)){const s=parseInt(a),p=t(i)[s];t(d)[a].forEach(m=>{const C=t(i)[m];r.push([p,C])})}return r}),g=b(1e5),M=b(0),K,k=b("Initialize random edges"),le={"Initialize random edges":()=>{L(),o(k,"Solve quickly")},"Solve quickly":()=>{K=Pe(t(d)),ue(),o(k,"Wait, slow that down")},"Wait, slow that down":()=>{o(d,A(K)),de(),o(k,"Wow cool")},"Wow cool":()=>{o(k,"Start over")},"Start over":()=>{o(d,A({})),I(),o(k,"Initialize random edges")}};function I(){o(i,A(new Array(t(l))));for(var r=0;r<t(l);++r)t(i)[r]={x:.1*u+.9*u*Math.random(),y:.05*_+.9*_*Math.random(),r:3,color:"black"}}I();function L(){o(d,A({})),t(i).forEach((r,a)=>{let s=[];fe(t(i),t(c)).forEach(p=>{s.push(p)}),t(d)[a]=s})}function ce(r){return Array.from({length:r},(a,s)=>s)}function fe(r,a){return[...ce(r.length)].sort(()=>.5-Math.random()).slice(0,a)}function ue(){o(M,0);for(let r=0;r<t(f);r++)Q(!0)}function de(){o(S,!0),o(M,0);let r=0;function a(){r<t(f)?(Q(),r++,setTimeout(a,250)):o(S,!1)}a()}function Q(r){o(g,A(t(g)>=t(l)-1?0:t(g)+1)),r||P(t(g),{color:"red",r:10}),o(M,t(M)+1);let a=t(d)[t(g)]||[],s=[...new Set(a.flatMap(h=>t(d)[h]||[]).filter(h=>h!==t(g)&&!a.includes(h)))],p=[...a,...s],m=p.map(h=>(r||(P(h,{color:"grey",r:5}),U(t(g),{color:"black",r:3},50)),he(t(i)[h],t(i)[t(g)]))),C=Array.from({length:m.length},(h,J)=>J).sort((h,J)=>m[h]<m[J]?1:-1).slice(0,t(c));t(d)[t(g)]=C.map(h=>p[h]),r||U(t(g),{color:"black",r:3},100)}function P(r,a){t(i)[r]={...t(i)[r],...a}}function U(r,a,s){setTimeout(()=>{P(r,a)},s)}function he(r,a){let s=0;return s+=Math.pow(r.x-a.x,2),s+=Math.pow(r.y-a.y,2),1/(1+Math.sqrt(s))}var X=qe(),z=v(Ae(X),6),N=v(y(z));N.__click=[je,le,k];var _e=y(N,!0);w(N),w(z);var T=v(z,2),j=y(T),B=v(y(j));O(B),B.__change=I,w(j);var W=v(j,2),q=v(y(W));O(q),q.__change=L,w(W);var Y=v(W,2),$=y(Y),ee=v($);O(ee),w(Y),w(T);var te=v(T,2),re=y(te),ae=y(re);se(ae,17,()=>t(i),ie,(r,a)=>{var s=Be();F(()=>{x(s,"cx",t(a).x),x(s,"cy",t(a).y),x(s,"r",t(a).r),x(s,"fill",t(a).color)}),D(r,s)});var me=v(ae);se(me,17,()=>t(H),ie,(r,a)=>{let s=()=>t(a)[0],p=()=>t(a)[1];var m=We();F(()=>{x(m,"x1",s().x),x(m,"x2",p().x),x(m,"y1",s().y),x(m,"y2",p().y)}),D(r,m)}),w(re),w(te),F(()=>{ze(N,`px-2 py-1 text-white ${(t(S)?"bg-gray-400":"bg-blue-500 hover:bg-blue-600")??""} rounded  focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 inline-flex items-center`),N.disabled=t(S),ne(_e,t(k)),ne($,`Iterations: ${t(M)??""} / `)}),V(B,()=>t(l),r=>o(l,r)),V(q,()=>t(c),r=>o(c,r)),V(ee,()=>t(f),r=>o(f,r)),D(e,X),Se()}Ee(["click","change"]);export{Re as default,Ze as metadata};
