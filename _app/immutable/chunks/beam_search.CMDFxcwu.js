import{a as F,t as ge,n as oe}from"./disclose-version.dX1e3oqb.js";import{ab as _e,d as ve,a6 as pe,az as be,h as ye,u as we,b as xe,p as ke,ax as b,s as v,j as Se,t as J,a as Me,g as t,R as s,c as y,r as w,C as Ae}from"./runtime.DnGnsA3j.js";import{l as ze,d as Ee,s as ae}from"./render.BTpR-0LY.js";import{e as ne,i as ie}from"./each.CakvZEPp.js";import{r as O,s as x}from"./attributes.DFiExn9Q.js";import{s as Ie}from"./class.DJ1x34kL.js";import{p as M}from"./proxy.C4QZwyNE.js";const Pe=[];function Te(e,o=!1){return E(e,new Map,"",Pe)}function E(e,o,c,g,l=null){if(typeof e=="object"&&e!==null){var i=o.get(e);if(i!==void 0)return i;if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(_e(e)){var f=Array(e.length);o.set(e,f),l!==null&&o.set(l,f);for(var h=0;h<e.length;h+=1){var S=e[h];h in e&&(f[h]=E(S,o,c,g))}return f}if(ve(e)===pe){f={},o.set(e,f),l!==null&&o.set(l,f);for(var u in e)f[u]=E(e[u],o,c,g);return f}if(e instanceof Date)return structuredClone(e);if(typeof e.toJSON=="function")return E(e.toJSON(),o,c,g,e)}if(e instanceof EventTarget)return e;try{return structuredClone(e)}catch{return e}}function R(e,o,c=o){var g=be();ze(e,"input",l=>{var i=l?e.defaultValue:e.value;if(i=V(e)?Z(i):i,c(i),g&&i!==(i=o())){var f=e.selectionStart,h=e.selectionEnd;e.value=i??"",h!==null&&(e.selectionStart=f,e.selectionEnd=Math.min(h,e.value.length))}}),(ye&&e.defaultValue!==e.value||we(o)==null&&e.value)&&c(V(e)?Z(e.value):e.value),xe(()=>{var l=o();V(e)&&l===Z(e.value)||e.type==="date"&&!l&&!e.value||l!==e.value&&(e.value=l??"")})}function V(e){var o=e.type;return o==="number"||o==="range"}function Z(e){return e===""?null:+e}const Ve={layout:"post",title:"Beam search nearest neighbors",summary:"A visualization of my favorite algorithm",date:"2015-12-28T00:00:00.000Z",updated:"2025-03-12T00:00:00.000Z"};function je(e,o,c){o[t(c)]()}var Be=oe("<circle></circle>"),Ne=oe('<line width="3" stroke="grey"></line>'),We=ge('<p>A common problem is finding the nearest neighbors of a given object in some search space. <a href="https://en.wikipedia.org/wiki/Beam_search" rel="nofollow">Beam search</a> is an “anytime” heuristic search algorithm which very efficiently accomplishes this.</p> <p>Imagine we have a set of N nodes, each randomly “closest” (connected by an edge) to n other nodes. The algorithm works as follows:</p> <ol><li>Pick a node; paint it red.</li> <li>Paint its neighbors grey. Also paint the neighbors for each of those neighbors.</li> <li>“Fix” the edges of the red node by connecting it to the closest of these grey nodes.</li> <li>Repeat for each node.</li></ol> <p>Click to proceed with the algorithm: <button> </button></p> <div class="flex"><div>Number of nodes: <input class="w-8 text-blue-500"></div> <div>Number of neighbors to find: <input class="w-8 text-blue-500"></div> <div> <input class="w-8 text-blue-500"></div></div> <div class="w-full flex justify-center mt-12 mb-32"><svg class="w-full mx-auto" viewBox="0 0 1000 300"><!><!></svg></div>',1);function Ze(e,o){ke(o,!0);let c=b(50),g=b(3),l=b(75),i=b(void 0);const f=1e3,h=300;let S=b(!1),u=b(M({})),G=Ae(()=>{const r=[];for(const a in t(u)){const n=parseInt(a),p=t(i)[n];t(u)[a].forEach(m=>{const C=t(i)[m];r.push([p,C])})}return r}),_=b(1e5),A=b(0),H,k=b("Initialize random edges"),se={"Initialize random edges":()=>{K(),s(k,"Solve quickly")},"Solve quickly":()=>{H=Te(t(u)),fe(),s(k,"Wait, slow that down")},"Wait, slow that down":()=>{s(u,M(H)),ue(),s(k,"Wow cool")},"Wow cool":()=>{s(k,"Start over")},"Start over":()=>{s(u,M({})),I(),s(k,"Initialize random edges")}};function I(){s(i,M(new Array(t(c))));for(var r=0;r<t(c);++r)t(i)[r]={x:.1*f+.9*f*Math.random(),y:.05*h+.9*h*Math.random(),r:3,color:"black"}}I();function K(){s(u,M({})),t(i).forEach((r,a)=>{let n=[];ce(t(i),t(g)).forEach(p=>{n.push(p)}),t(u)[a]=n})}function le(r){return Array.from({length:r},(a,n)=>n)}function ce(r,a){return[...le(r.length)].sort(()=>.5-Math.random()).slice(0,a)}function fe(){s(A,0);for(let r=0;r<t(l);r++)L(!0)}function ue(){s(S,!0),s(A,0);let r=0;function a(){r<t(l)?(L(),r++,setTimeout(a,250)):s(S,!1)}a()}function L(r){s(_,M(t(_)>=t(c)-1?0:t(_)+1)),r||P(t(_),{color:"red",r:10}),s(A,t(A)+1);let a=t(u)[t(_)]||[],n=[...new Set(a.flatMap(d=>t(u)[d]||[]).filter(d=>d!==t(_)&&!a.includes(d)))],p=[...a,...n],m=p.map(d=>(r||(P(d,{color:"grey",r:5}),Q(t(_),{color:"black",r:3},50)),de(t(i)[d],t(i)[t(_)]))),C=Array.from({length:m.length},(d,D)=>D).sort((d,D)=>m[d]<m[D]?1:-1).slice(0,t(g));t(u)[t(_)]=C.map(d=>p[d]),r||Q(t(_),{color:"black",r:3},100)}function P(r,a){t(i)[r]={...t(i)[r],...a}}function Q(r,a,n){setTimeout(()=>{P(r,a)},n)}function de(r,a){let n=0;return n+=Math.pow(r.x-a.x,2),n+=Math.pow(r.y-a.y,2),1/(1+Math.sqrt(n))}var U=We(),T=v(Se(U),6),z=v(y(T));z.__click=[je,se,k];var he=y(z,!0);w(z),w(T);var j=v(T,2),B=y(j),N=v(y(B));O(N),N.__change=I,w(B);var W=v(B,2),q=v(y(W));O(q),q.__change=K,w(W);var X=v(W,2),Y=y(X),$=v(Y);O($),w(X),w(j);var ee=v(j,2),te=y(ee),re=y(te);ne(re,17,()=>t(i),ie,(r,a)=>{var n=Be();J(()=>{x(n,"cx",t(a).x),x(n,"cy",t(a).y),x(n,"r",t(a).r),x(n,"fill",t(a).color)}),F(r,n)});var me=v(re);ne(me,17,()=>t(G),ie,(r,a)=>{let n=()=>t(a)[0],p=()=>t(a)[1];var m=Ne();J(()=>{x(m,"x1",n().x),x(m,"x2",p().x),x(m,"y1",n().y),x(m,"y2",p().y)}),F(r,m)}),w(te),w(ee),J(()=>{Ie(z,`px-2 py-1 text-white ${(t(S)?"bg-gray-400":"bg-blue-500 hover:bg-blue-600")??""} rounded  focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 inline-flex items-center`),z.disabled=t(S),ae(he,t(k)),ae(Y,`Iterations: ${t(A)??""} / `)}),R(N,()=>t(c),r=>s(c,r)),R(q,()=>t(g),r=>s(g,r)),R($,()=>t(l),r=>s(l,r)),F(e,U),Me()}Ee(["click","change"]);export{Ze as default,Ve as metadata};
