<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/0.DDVbrjWY.css" rel="stylesheet">
		<link href="../_app/immutable/assets/5.BidhpuIP.css" rel="stylesheet">
		<link href="../_app/immutable/assets/farkle.BopMSokE.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.CoJ4Yh99.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/entry.BfmsGetp.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/runtime.Bx1PZc6z.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/control.CYgJF_JY.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.C2xWi1Sb.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper.C1FmrZbK.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/render.Cwa2x4Na.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/misc.B9QI8j-U.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/disclose-version.CcgT32Hh.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/if.D8GCrRWd.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/proxy.BceImc8g.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/this.BWfFXI4S.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/props.xk4mLi48.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/store.Cst2OyEt.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.KQ3HUm4-.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/snippet.D9gtACrt.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/2.BdlyGI6H.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/5.D_84EcN4.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/attributes.B4JaOE4d.js"><!--[--><meta data-key="description" name="description"> <meta property="og:type" content="article"> <meta property="og:title" content="Layouts"> <meta name="twitter:title" content="Layouts"> <meta property="og:description"> <meta name="twitter:description"> <meta property="og:image:width"> <meta property="og:image:height"><!--]--><title>Layouts</title>
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!----><!--[--><!----><!----><article class="tracking-wide prose mx-auto mt-16 prose-a:text-twirl prose-pre:border prose-pre:border-neutral-700 prose-img:rounded-xl prose-figcaption:lg:-ml-[5ch] prose-figcaption:lg:max-w-[75ch] prose-img:lg:-ml-[5ch] prose-img:lg:max-w-[90ch] px-8 lg:max-w-[85ch] mb-16 svelte-186u6n8"><a href="/blog" class="text-gray-500 hover:text-gray-700">← Back</a> <img class="cover-image" alt="" style="aspect-ratio:  / ;"> <div class="flex gap-2 text-sm">March 28, 2025</div> <h1 class="text-5xl font-[400] text-purple mt-6 mb-12">Layouts</h1> <p>A layout algorithm is a structured approach to rendering information: specifically it solves the problem of <em>where do things go</em>.</p> <p>You’re looking at a web page right now organized by layout algorithms that implement the <a href="https://developer.mozilla.org/en-US/docs/Learn_web_development/Core/Styling_basics/Box_model" rel="nofollow">CSS Box Model</a>. This page benefits from layout tree construction, box size calculation, flow layout algorithms and positioning algorithms.</p> <p>I find layout algorithms really interesting. They drive so much of how we interact with the digital world, and when they work well they seem amost magical.</p> <p>So I thought today I’d take a look at a class of layout algorithms called <em>hierarchical</em> layout algorithms. These represent information that can be encoded in a graph, like a tree or diagram.</p> <p>The problem is, given a set of nodes and edges:</p> <!----><pre class="shiki nord" style="background-color:#2e3440ff;color:#d8dee9ff" tabindex="0"><code><span class="line"><span style="color:#ECEFF4">&#123;</span></span>
<span class="line"><span style="color:#D8DEE9FF">    nodes</span><span style="color:#ECEFF4">:</span><span style="color:#D8DEE9FF"> [</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">🐄</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">🥛</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">🧀</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">🧈</span><span style="color:#ECEFF4">"</span><span style="color:#D8DEE9FF">]</span><span style="color:#ECEFF4">,</span></span>
<span class="line"><span style="color:#D8DEE9FF">    edges</span><span style="color:#ECEFF4">:</span><span style="color:#D8DEE9FF"> [</span></span>
<span class="line"><span style="color:#ECEFF4">        &#123;</span><span style="color:#88C0D0">in</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">🐄</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#88C0D0"> out</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">🥛</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">&#125;,</span></span>
<span class="line"><span style="color:#ECEFF4">        &#123;</span><span style="color:#88C0D0">in</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">🥛</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#88C0D0"> out</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">🧀</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">&#125;,</span></span>
<span class="line"><span style="color:#ECEFF4">        &#123;</span><span style="color:#88C0D0">in</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">🥛</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#88C0D0"> out</span><span style="color:#ECEFF4">:</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">🧈</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">&#125;,</span></span>
<span class="line"><span style="color:#D8DEE9FF">    ]</span></span>
<span class="line"><span style="color:#ECEFF4">&#125;</span></span></code></pre><!----> <p>How do we generate something like this?</p> <svg class="w-1/2 mx-auto" viewBox="30 0 250 80"><defs><marker id="arrowhead" markerWidth="6" markerHeight="7" refX="4" refY="3.5" orient="auto"><polygon points="0 0, 6 3.5, 0 7"></polygon></marker></defs><text x="50" y="50" font-size="20">🐄</text><text x="150" y="50" font-size="20">🥛</text><text x="250" y="20" font-size="20">🧀</text><text x="250" y="80" font-size="20">🧈</text><line x1="85" y1="45" x2="135" y2="45" style="stroke:rgb(0,0,0);stroke-width:2" marker-end="url(#arrowhead)"></line><line x1="185" y1="45" x2="235" y2="25" style="stroke:rgb(0,0,0);stroke-width:2" marker-end="url(#arrowhead)"></line><line x1="185" y1="45" x2="235" y2="65" style="stroke:rgb(0,0,0);stroke-width:2" marker-end="url(#arrowhead)"></line></svg> <p>Drawing the diagram is easy enough in javascript if you know the coordinates— but how do you know the right coordinates?</p> <p>The industry standard is something called <a href="https://en.wikipedia.org/wiki/Layered_graph_drawing" rel="nofollow">Sugiyama</a>, but implementing it can be thousands of lines of code— see the Javascript implementation, <a href="https://github.com/dagrejs/dagre" rel="nofollow">Dagre</a>, for more on that.</p> <p>Because of space and brain constraints, we’ll look at a common simpler option: the <a href="https://reingold.co/tidier-drawings.pdf" rel="nofollow">Reingold-Tilford algorithm</a>.</p> <h2>Reingold-Tilford</h2> <p>Reingold-Tilford requires us to do four passes over the data:</p> <ol><li>Assign initial coordinates</li> <li>Resolve conflicts between subtrees</li> <li>Apply modifiers to the final coordinates</li> <li>Normalize coordinates</li></ol> <p>Before we do the first step we need to construct a Tree structure:</p> <p>Then assigning initial coordinates is as simple as walking through the tree recursively and</p> <ol><li>Calculate the depth of each node</li> <li>Calculate a position that is in the center of its children</li></ol> <p>Let’s walk through the steps:</p> <span class="bg-gray-200"></span> <div class="flex gap-6"><svg style="height: 15rem;" class="transition-all flex-grow" viewBox="0 -50 100 150"><!--[--><text x="0" y="0">🐄</text><text x="0" y="0">🥛</text><text x="0" y="0">🧀</text><text x="0" y="0">🧈</text><!--]--><!--[!--><!--]--></svg> <div class="w-1/2"><p class="text-yellow-400">We start with our nodes all piled up on top of each other. The first step is to calculate *depth*.</p> <button class="px-2 py-1 text-white rounded bg-yellow-500">click here</button></div></div> <div class="hidden md:flex w-full bg-[#2e3440ff] min-h-[20rem] rounded"><!---->beep boop<!----></div> <!--[--><p>and that’s pretty much sufficient for a really simple tree like this one!</p> <p>If you click to try it again, we’ll redo the same example but with 6 extra items and 10 additional edges. You’ll see that because of items having parents at multiple depths, it can be tricky to get a pleasing layout.</p><!--]--> <p>In another post (or maybe just extending this one in the future) we’ll look at the solution: resolving conflicts with modifiers and normalizing coordinates, and maybe arrows.</p><!----> <div class="mt-16"><a href="/blog" class="text-gray-500 hover:text-gray-700">← Back</a></div></article><!----><!----><!----><!--]--><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_1apmcgr = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [null,null,null];

					Promise.all([
						import("../_app/immutable/entry/start.CoJ4Yh99.js"),
						import("../_app/immutable/entry/app.C2xWi1Sb.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 5],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
